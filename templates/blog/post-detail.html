{% extends '../base/base.html' %}
{% load static %}

{% block content %}


{% if user.is_authenticated %}
<form method="POST">
        {% csrf_token %}
        {{ form.as_table }}
        <button type="submit">Comment!</button>
</form>
{% else %}
<div>Login to make a comment</div>
{% endif %}

<div class='post'>
        {% if user.is_staff %}
                <div><a href="{% url 'blog-post-delete' post.id%}">Delete</a></div>
        {% endif %}

        
                {% if post.cover %}

                <div class='post__cover'>
                <img src="{{ post.cover.url}}"
                     alt="">
        </div>
                {% else %}
                
                <div class='post__cover'>
                <img src="{% static "./img/logo.svg" %}"
                     alt="">
        </div>
                {% endif %}


        <h2 class='post__title'> {{ post.title}}</h2>
        <h3 class='post__author'> <a href="{% url 'blog-profile-detail' post.author.id %}">{{post.author}}</a></h3>
        <div class='post__body'> {{ post.body|safe}}</div>



        {% if not post.comments.all %}
        <div>No comments yet... </div>
        {% else %}


        {% for comment in post.comments.all %}
        {% if comment.parent is Null and comment.enabled is True %}
        <h2>{{comment.author}} {{ comment.upload_date}} {{ comment.id }} {{ comment.body }}</h2>
        {% endif %}

        <!-- {% for reply in comment.replies.all %}
        <p>{{comment.author}} {{ comment.upload_date}} ({{reply.parent.id}}){{ reply.body }}</p>
        {% endfor %} -->
        {% endfor %}
        {% endif %}
        {{ alert }}




</div>








{% endblock content %}

{% block scripts %}
<script src={% static "./scripts/modal-view.js" %}></script>
<script src={% static "./scripts/toggle-nav.js" %}></script>
<script src={% static "./scripts/scroll-navigation.js" %}></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"
        integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/"
        crossorigin="anonymous"></script>
{% endblock scripts %}
